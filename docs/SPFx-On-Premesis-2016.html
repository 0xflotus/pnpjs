<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div>
            <div class="logo">
                <img src="img/office365-header-icon.png" alt="Logo" />
            </div>
            <div class="pnp-title">
                <span id="headerText">
                    <a href="/pnpjs">SharePoint Patterns and Practices</a>
                </span>
                <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
            </div>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/SPFx-On-Premesis-2016.html">SPFx On Premesis 2016</a>
    </nav>

    <article>
        <h1 id="workaround-for-spfx-typescript-version">Workaround for SPFx TypeScript Version <a class="permalink" href="#workaround-for-spfx-typescript-version" aria-hidden="true">#</a></h1>
<p><em>Note this article applies to version 1.4.1 SharePoint Framework projects targetting on-premesis only.</em></p>
<p>When using the Yeoman generator to create a SharePoint Framework 1.4.1 project targeting on-premesis it installs TypeScript version 2.2.2. Unfortunately this library relies on 2.4.2 or later due to extensive use of default values for generic type parameters in the libraries. To work around this limitation you can follow the steps in this article.</p>
<ol>
<li>Open package-lock.json</li>
<li>Search for <code>&quot;typescript&quot;: &quot;2.2.2&quot;</code></li>
<li>Replace “2.2.2” with “2.4.2”</li>
<li>Search for the next “typescript” occurance and replace the block with:</li>
</ol>
<pre><code class="language-JSON">"typescript": {
  "version": "2.4.2",
  "resolved": "https://registry.npmjs.org/typescript/-/typescript-2.4.2.tgz",
  "integrity": "sha1-+DlfhdRZJ2BnyYiqQYN6j4KHCEQ=",
  "dev": true
}
</code></pre>
<p><img src="img/SPFx-On-Premesis-2016-1.png" alt="Replacement blocks highlighted" /></p>
<ol start="5">
<li>Remove node_modules folder <code>rm -rf node_modules/</code></li>
<li>Run <code>npm install</code></li>
</ol>
<p>This can be checked with:</p>
<pre><code>npm list typescript
</code></pre>
<pre><code>+-- @microsoft/sp-build-web@1.1.0
| `-- @microsoft/gulp-core-build-typescript@3.1.1
|   +-- @microsoft/api-extractor@2.3.8
|   | `-- typescript@2.4.2
|   `-- typescript@2.4.2
</code></pre>

    </article>

    <footer>
        <div class="brand">© Microsoft 2018</div>
        <div class="call-to-action">Please <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: SPFx-On-Premesis-2016.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/SPFx-On-Premesis-2016" alt="spacer" />