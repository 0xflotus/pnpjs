<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div class="right">
            <form method="get" action="http://www.bing.com/search">
                <input type="text" name="q" size="25" maxlength="255" value="" placeholder="Search this site..." />
                <input type="hidden" name="q1" value="site:https://pnp.github.io/pnpjs/" />
                <input type="submit" value="Search" />
            </form>
        </div>
        <div class="logo">
            <img src="/pnpjs/img/office365-header-icon.png" alt="Logo" />
        </div>
        <div class="pnp-title">
            <span id="headerText">
                <a href="/pnpjs">SharePoint Patterns and Practices</a>
            </span>
            <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/odata">odata</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/odata/core.html">core</a>
    </nav>

    <article>
        <h1 id="pnpodatacore">@pnp/odata/core <a class="permalink" href="#pnpodatacore" aria-hidden="true">#</a></h1>
<p>This modules contains shared interfaces and abstract classes used within, and by inheritors of, the @pnp/odata package.</p>
<h2 id="processhttpclientresponseexception">ProcessHttpClientResponseException <a class="permalink" href="#processhttpclientresponseexception" aria-hidden="true">#</a></h2>
<p>The exception thrown when a response is returned and cannot be processed.</p>
<h2 id="interface-odataparser">interface ODataParser<T> <a class="permalink" href="#interface-odataparser" aria-hidden="true">#</a></h2>
<p>Base interface used to descibe a class that that will parse incoming responses. It takes a single type parameter representing the type of the
value to be returned. It has two methods, one is optional:</p>
<ul>
<li>parse(r: Response): Promise<T> - main method use to parse a response and return a Promise resolving to an object of type T</li>
<li>hydrate?: (d: any) =&gt; T - optional method used when getting an object from the <a href="caching.html">cache</a> if it requires calling a constructor</li>
</ul>
<h2 id="odataparserbase">ODataParserBase<T> <a class="permalink" href="#odataparserbase" aria-hidden="true">#</a></h2>
<p>The base class used by all parsers in the @pnp libraries. It is optional to use when creating your own custom parsers, but does contain several helper
methods.</p>
<h3 id="create-a-custom-parser-from-odataparserbase">Create a custom parser from ODataParserBase<T> <a class="permalink" href="#create-a-custom-parser-from-odataparserbase" aria-hidden="true">#</a></h3>
<p>You can always create custom parsers for your projects, however it is likely you will not require this step as the default parsers should work for most
cases.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">class</span> MyParser <span class="hljs-keyword">extends</span> ODataParserBase&lt;<span class="hljs-built_in">any</span>&gt; {

    <span class="hljs-comment">// we need to override the parse method to do our custom stuff</span>
    <span class="hljs-keyword">public</span> parse(r: Response): <span class="hljs-built_in">Promise</span>&lt;T&gt; {

        <span class="hljs-comment">// we wrap everything in a promise</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {

            <span class="hljs-comment">// lets use the default error handling which returns true for no error</span>
            <span class="hljs-comment">// and will call reject with an error if one exists</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.handleError(r, reject)) {

                <span class="hljs-comment">// now we add our custom parsing here</span>
                r.text().then(<span class="hljs-function"><span class="hljs-params">txt</span> =&gt;</span> {
                    <span class="hljs-comment">// here we call a madeup function to parse the result</span>
                    <span class="hljs-comment">// this is where we would do our parsing as required</span>
                    myCustomerUnencode(txt).then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {
                        resolve(v);
                    });
                });
            }
        });
    }
}
</code></pre>

    </article>

    <footer>
        <div class="brand">Â© Microsoft 2018</div>
        <div class="call-to-action">Please
            <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: odata\core.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/odata/docs/core" alt="spacer" />