<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div>
            <div class="logo">
                <img src="img/office365-header-icon.png" alt="Logo" />
            </div>
            <div class="pnp-title">
                <span id="headerText">
                    <a href="/pnpjs">SharePoint Patterns and Practices</a>
                </span>
                <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
            </div>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp-taxonomy">sp taxonomy</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp-taxonomy/term-stores.html">term stores</a>
    </nav>

    <article>
        <h1 id="pnpsp-taxonomytermstores">@pnp/sp-taxonomy/termstores <a class="permalink" href="#pnpsp-taxonomytermstores" aria-hidden="true">#</a></h1>
<p>Term stores contain term groups, term sets, and terms. This article describes how to work find, load, and use a term store to access the terms inside.</p>
<h2 id="list-term-stores">List term stores <a class="permalink" href="#list-term-stores" aria-hidden="true">#</a></h2>
<p>You can access a list of all term stores via the <em>termstores</em> property of the Taxonomy class.</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">// get a list of term stores and return all properties</span>
<span class="hljs-keyword">const</span> stores = <span class="hljs-keyword">await</span> taxonomy.termStores.get();

<span class="hljs-comment">// you can also select the fields to return for the term stores using the select operator.</span>
<span class="hljs-keyword">const</span> stores2 = <span class="hljs-keyword">await</span> taxonomy.termStores.select(<span class="hljs-string">"Name"</span>).get();
</code></pre>
<h2 id="load-a-term-store">Load a term store <a class="permalink" href="#load-a-term-store" aria-hidden="true">#</a></h2>
<p>To load a specific term store you can use the <em>getByName</em> or <em>getById</em> methods. Using the <em>get</em> method executes the request to the server.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">const</span> store = <span class="hljs-keyword">await</span> taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>).get();

<span class="hljs-keyword">const</span> store2 = <span class="hljs-keyword">await</span> taxonomy.termStores.getById(<span class="hljs-string">"f6112509-fba7-4544-b2ed-ce6c9396b646"</span>).get();

<span class="hljs-comment">// you can use select as well with either method to choose the fields to return</span>
<span class="hljs-keyword">const</span> store3 = <span class="hljs-keyword">await</span> taxonomy.termStores.getById(<span class="hljs-string">"f6112509-fba7-4544-b2ed-ce6c9396b646"</span>).select(<span class="hljs-string">"Name"</span>).get();
</code></pre>
<p>For term stores and all other objects data is returned as a merger of the data and a new instance of the representative class. Allowing you to immediately begin acting on the object. IF you do not need the data, skip the get call until you do.</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">// no data loaded yet, store is an instance of TermStore class</span>
<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-comment">// I can call subsequent methods on the same object and will now have an object with data</span>
<span class="hljs-comment">// I could have called get above as well - this is just an example</span>
<span class="hljs-keyword">const</span> store2: ITermStore &amp; ITermStoreData = <span class="hljs-keyword">await</span> store.get();

<span class="hljs-comment">// log the Name property</span>
<span class="hljs-built_in">console</span>.log(store2.Name);

<span class="hljs-comment">// call another TermStore method on the same object</span>
<span class="hljs-keyword">await</span> store2.addLanguage(<span class="hljs-number">1031</span>);
</code></pre>
<h2 id="term-store-methods-and-properties">Term store methods and properties <a class="permalink" href="#term-store-methods-and-properties" aria-hidden="true">#</a></h2>
<h3 id="get">get <a class="permalink" href="#get" aria-hidden="true">#</a></h3>
<p>Loads the data for this term store</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = <span class="hljs-keyword">await</span> taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>).get();
</code></pre>
<h3 id="gettermsetsbyname">getTermSetsByName <a class="permalink" href="#gettermsetsbyname" aria-hidden="true">#</a></h3>
<p>Gets the collection of term sets with a matching name</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermSets } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> sets: ITermSets = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>).getTermSetsByName(<span class="hljs-string">"My Set"</span>, <span class="hljs-number">1033</span>);
</code></pre>
<h3 id="gettermsetbyid">getTermSetById <a class="permalink" href="#gettermsetbyid" aria-hidden="true">#</a></h3>
<p>Gets the <a href="term-sets.html">term set</a> with a matching id</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore, ITermSet } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-comment">// note that you can also use instances if you wanted to conduct multiple operations on a single store</span>
<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);
<span class="hljs-keyword">const</span> <span class="hljs-keyword">set</span>: ITermSet = store.getTermSetById(<span class="hljs-string">"0ba6845c-1468-4ec5-a5a8-718f1fb05431"</span>);
<span class="hljs-comment">// we will handle normalizing guids for you as well :)</span>
<span class="hljs-keyword">const</span> set2: ITermSet = store.getTermSetById(<span class="hljs-string">"{a63aefc9-359d-42b7-a0d2-cb1809acd260}"</span>);
</code></pre>
<h3 id="gettermbyid">getTermById <a class="permalink" href="#gettermbyid" aria-hidden="true">#</a></h3>
<p>Gets a <a href="terms.html">term</a> by id</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore, ITerm, ITermData } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-keyword">const</span> term: ITerm = store.getTermById(<span class="hljs-string">"0ba6845c-1468-4ec5-a5a8-718f1fb05431"</span>);
<span class="hljs-keyword">const</span> termWithData: ITerm &amp; ITermData = <span class="hljs-keyword">await</span> term.get();
</code></pre>
<h3 id="gettermgroupbyid">getTermGroupById <a class="permalink" href="#gettermgroupbyid" aria-hidden="true">#</a></h3>
<p>Gets a <a href="term-groups.html">term group</a> by id</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore, ITermGroup } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-keyword">const</span> group: ITermGroup = store.getTermGroupById(<span class="hljs-string">"0ba6845c-1468-4ec5-a5a8-718f1fb05431"</span>);
</code></pre>
<h3 id="getterms">getTerms <a class="permalink" href="#getterms" aria-hidden="true">#</a></h3>
<p>Gets <a href="terms.html">terms</a> that match the provided criteria. Please see <a href="https://msdn.microsoft.com/en-us/library/hh626704%28v=office.12%29.aspx">this article</a> for details on valid querys.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore, ILabelMatchInfo, ITerm, ITermData } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-keyword">const</span> terms: ITerms = store.getTerms({
                                TermLabel: <span class="hljs-string">"test label"</span>,
                                TrimUnavailable: <span class="hljs-literal">true</span>,
                            });

<span class="hljs-comment">// load the data based on the above query</span>
<span class="hljs-keyword">const</span> termsWithData: (ITerm &amp; ITermData)[] = terms.get();

<span class="hljs-comment">// select works here too :)</span>
<span class="hljs-keyword">const</span> termsWithData2: (ITerm &amp; ITermData)[] = terms.select(<span class="hljs-string">"Name"</span>).get();
</code></pre>
<h3 id="addlanguage">addLanguage <a class="permalink" href="#addlanguage" aria-hidden="true">#</a></h3>
<p>Adds a language to the term store by LCID</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-keyword">await</span> store.addLanguage(<span class="hljs-number">1031</span>);
</code></pre>
<h3 id="addgroup">addGroup <a class="permalink" href="#addgroup" aria-hidden="true">#</a></h3>
<p>Adds a <a href="term-groups.html">term group</a> to the term store</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-keyword">const</span> group: ITermGroup &amp; ITermGroupData = <span class="hljs-keyword">await</span> store.addGroup(<span class="hljs-string">"My Group Name"</span>);

<span class="hljs-comment">// you can optionally specify the guid of the group, if you don't we just create a new guid for you</span>
<span class="hljs-keyword">const</span> groups: ITermGroup &amp; ITermGroupData = <span class="hljs-keyword">await</span> store.addGroup(<span class="hljs-string">"My Group Name"</span>, <span class="hljs-string">"0ba6845c-1468-4ec5-a5a8-718f1fb05431"</span>);
</code></pre>
<h3 id="commitall">commitAll <a class="permalink" href="#commitall" aria-hidden="true">#</a></h3>
<p>Commits all updates to the database that have occurred since the last commit or rollback.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-keyword">await</span> store.commitAll();
</code></pre>
<h3 id="deletelanguage">deleteLanguage <a class="permalink" href="#deletelanguage" aria-hidden="true">#</a></h3>
<p>Delete a working language from the TermStore</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-keyword">await</span> store.deleteLanguage(<span class="hljs-number">1031</span>);
</code></pre>
<h3 id="rollbackall">rollbackAll <a class="permalink" href="#rollbackall" aria-hidden="true">#</a></h3>
<p>Discards all updates that have occurred since the last commit or rollback. It is unlikely you will need to call this method through this library due to how things are structured.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { taxonomy, ITermStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp-taxonomy"</span>;

<span class="hljs-keyword">const</span> store: ITermStore = taxonomy.termStores.getByName(<span class="hljs-string">"Taxonomy_v5o/SbcTE2cegwO2dtAN9l=="</span>);

<span class="hljs-keyword">await</span> store.rollbackAll();
</code></pre>

    </article>

    <footer>
        <div class="brand">© Microsoft 2018</div>
        <div class="call-to-action">Please <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp-taxonomy\term-stores.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp-taxonomy/docs/term-stores" alt="spacer" />