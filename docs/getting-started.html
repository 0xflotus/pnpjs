<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <span id="headerText">
            <a href="/pnpjs">SharePoint Patterns and Practices</a>
        </span>
        <span id="subheaderText">Client Side Libraries</span>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/getting-started.html">getting started</a>
    </nav>

    <article>
        <h1 id="getting-started">Getting Started <a class="permalink" href="#getting-started" aria-hidden="true">#</a></h1>
<p>These libraries are geared towards folks working with TypeScript but will work equally well for JavaScript projects. To get started you need to install
the libraries you need via npm. Many of the packages have a peer dependency to other packages with the @pnp namespace meaning you may need to install
more than one package. All packages are released together eliminating version confusion - all packages will depend on packages with the same version number.</p>
<p>If you need to support older browsers please review the article on <a href="polyfill.html">polyfills</a> for required functionality.</p>
<h2 id="install">Install <a class="permalink" href="#install" aria-hidden="true">#</a></h2>
<p>First you will need to install those libraries you want to use in your application. Here we will install the most frequently used packages. This step applies to any
environment or project.</p>
<p><code>npm install @pnp/logging @pnp/common @pnp/odata @pnp/sp @pnp/graph --save</code></p>
<p>Next we can import and use the functionality within our application. The below is a very simple example, please see the individual package documentation
for more details.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { Util } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/common"</span>;

(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

  <span class="hljs-comment">// get and log a random string</span>
  <span class="hljs-built_in">console</span>.log(Util.getRandomString(<span class="hljs-number">20</span>));

})()
</code></pre>
<h2 id="getting-started-with-sharepoint-framework">Getting Started with SharePoint Framework <a class="permalink" href="#getting-started-with-sharepoint-framework" aria-hidden="true">#</a></h2>
<p>The @pnp/sp and @pnp/graph libraries are designed to work seamlessly within SharePoint Framework projects with a small amount of upfront configuration. If you are running in 2016 on-premesis please <a href="SPFx-On-Premesis-2016.html">read this note</a> on a workaround for the included TypeScript version. If you are targetting SharePoint online you do not need to take any additional steps.</p>
<h3 id="establish-context">Establish Context <a class="permalink" href="#establish-context" aria-hidden="true">#</a></h3>
<p>Because SharePoint Framework provides a local context to each component we need to set that context within the library. This allows us to determine request
urls as well as use the SPFx HttpGraphClient within @pnp/graph. There are two ways to provide the spfx context to the library. Either through the setup method
imported from @pnp/common or using the setup method on either the @pnp/sp or @pnp/graph main export. All three are shown below and are equivalent, meaning if
you are already importing the sp variable from @pnp/sp or the graph variable from @pnp/graph you should use their setup method to reduce imports.</p>
<p>The setup is always done in the onInit method to ensure it runs before your other lifecycle code. You can also set any other settings at this time.</p>
<h4 id="using-pnpcommon-setup">Using @pnp/common setup <a class="permalink" href="#using-pnpcommon-setup" aria-hidden="true">#</a></h4>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { setup <span class="hljs-keyword">as</span> pnpSetup } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/common"</span>;

<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">public</span> onInit(): <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onInit().then(_ =&gt; {

    <span class="hljs-comment">// other init code may be present</span>

    pnpSetup({
      spfxContext: <span class="hljs-keyword">this</span>.context
    });
  });
}

<span class="hljs-comment">// ...</span>

</code></pre>
<h4 id="using-pnpsp-setup">Using @pnp/sp setup <a class="permalink" href="#using-pnpsp-setup" aria-hidden="true">#</a></h4>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">public</span> onInit(): <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onInit().then(_ =&gt; {

    <span class="hljs-comment">// other init code may be present</span>

    sp.setup({
      spfxContext: <span class="hljs-keyword">this</span>.context
    });
  });
}

<span class="hljs-comment">// ...</span>

</code></pre>
<h4 id="using-pnpgraph-setup">Using @pnp/graph setup <a class="permalink" href="#using-pnpgraph-setup" aria-hidden="true">#</a></h4>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { graph } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/graph"</span>;

<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">public</span> onInit(): <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onInit().then(_ =&gt; {

    <span class="hljs-comment">// other init code may be present</span>

    graph.setup({
      spfxContext: <span class="hljs-keyword">this</span>.context
    });
  });
}

<span class="hljs-comment">// ...</span>

</code></pre>
<h2 id="connect-to-sharepoint-from-node">Connect to SharePoint from Node <a class="permalink" href="#connect-to-sharepoint-from-node" aria-hidden="true">#</a></h2>
<p>Because peer dependencies are not installed automatically you will need to list out each package to install. Don’t worry if you forget one you will get a message
on the command line that a peer dependency is missing. Let’s for example look at installing the required libraries to connect to SharePoint from nodejs. You can see
<a href="https://github.com/pnp/pnpjs/blob/dev/debug/launch/sp.ts">./debug/launch/sp.ts</a> for a live example.</p>
<pre><code>npm i @pnp/logging @pnp/common @pnp/odata @pnp/sp @pnp/nodejs
</code></pre>
<p>This will install the logging, common, odata, sp, and nodejs packages. You can read more about what each package does starting on the <a href="packages.html">packages</a> page.
Once these are installed you need to import them into your project, to communicate with SharePoint from node we’ll need the following imports:</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;
<span class="hljs-keyword">import</span> { SPFetchClient } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/nodejs"</span>;
</code></pre>
<p>Once you have imported the necessary resources you can update your code to setup the node fetch client as well as make a call to SharePoint.</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">// configure your node options (only once in your application)</span>
sp.setup({
    sp: {
        fetchClientFactory: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SPFetchClient(<span class="hljs-string">"{site url}"</span>, <span class="hljs-string">"{client id}"</span>, <span class="hljs-string">"{client secret}"</span>);
        },
    },
});

<span class="hljs-comment">// make a call to SharePoint and log it in the console</span>
sp.web.select(<span class="hljs-string">"Title"</span>, <span class="hljs-string">"Description"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(w, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
});
</code></pre>
<h2 id="connect-to-microsoft-graph-from-node">Connect to Microsoft Graph From Node <a class="permalink" href="#connect-to-microsoft-graph-from-node" aria-hidden="true">#</a></h2>
<p>Similar to the above you can also make calls to the Graph api from node using the libraries. Again we start with installing the required resources. You can see
<a href="https://github.com/pnp/pnpjs/blob/dev/debug/launch/graph.ts">./debug/launch/graph.ts</a> for a live example.</p>
<pre><code>npm i @pnp/logging @pnp/common @pnp/odata @pnp/graph @pnp/nodejs
</code></pre>
<p>Now we need to import what we’ll need to call graph</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { graph } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/graph"</span>;
<span class="hljs-keyword">import</span> { AdalFetchClient } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/nodejs"</span>;
</code></pre>
<p>Now we can make our graph calls after setting up the Adal client. Note you’ll need to setup an AzureAD App registration with the necessary permissions.</p>
<pre><code class="language-TypeScript">graph.setup({
    graph: {
        fetchClientFactory: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AdalFetchClient(<span class="hljs-string">"{mytenant}.onmicrosoft.com"</span>, <span class="hljs-string">"{application id}"</span>, <span class="hljs-string">"{application secret}"</span>);
        },
    },
});

<span class="hljs-comment">// make a call to Graph and get all the groups</span>
graph.v1.groups.get().then(<span class="hljs-function"><span class="hljs-params">g</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(g, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
});
</code></pre>
<h2 id="getting-started-outside-sharepoint-framework">Getting Started outside SharePoint Framework <a class="permalink" href="#getting-started-outside-sharepoint-framework" aria-hidden="true">#</a></h2>
<p>In some cases you may be working in a way such that we cannot determine the base url for the web. In this scenario you have two options.</p>
<h3 id="set-baseurl-through-setup">Set baseUrl through setup: <a class="permalink" href="#set-baseurl-through-setup" aria-hidden="true">#</a></h3>
<p>Here we are setting the baseUrl via the sp.setup method. We are also setting the headers to use verbose mode, something you may have to do when
working against unpatched versions of SharePoint 2013 as <a href="https://blogs.msdn.microsoft.com/patrickrodgers/2016/06/13/pnp-jscore-1-0-1/">discussed here</a>.
This is optional for 2016 or SharePoint Online.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

sp.setup({
  sp: {
    headers: {
      Accept: <span class="hljs-string">"application/json;odata=verbose"</span>,
    },
    baseUrl: <span class="hljs-string">"{Absolute SharePoint Web URL}"</span>
  },
});

<span class="hljs-keyword">const</span> w = <span class="hljs-keyword">await</span> sp.web.get();
</code></pre>
<h3 id="create-web-instances-directly">Create Web instances directly <a class="permalink" href="#create-web-instances-directly" aria-hidden="true">#</a></h3>
<p>Using this method you create the web directly with the url you want to use as the base.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { Web } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">const</span> web = <span class="hljs-keyword">new</span> Web(<span class="hljs-string">"{Absolute SharePoint Web URL}"</span>);
<span class="hljs-keyword">const</span> w = <span class="hljs-keyword">await</span> web.get();
</code></pre>

    </article>

    <footer>
        &copy; Microsoft 2018
        <br /> Please
        <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: getting-started.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/getting-started" alt="spacer" />