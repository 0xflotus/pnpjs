<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnp/css/default-highlightjs.css"> 
    <link rel="stylesheet" href="/pnp/css/site.css">
</head>

<body>
    <header>
        <span id="headerText"><a href="/pnp">SharePoint Patterns and Practices</a></span>
        <span id="subheaderText">Client Side Libraries</span>
    </header>

    <article>
        <h1>Polyfills</h1>
<p>These libraries may make use of some features not found in older browsers, mainly fetch or other es6 capabilities. This primarily affects Internet Explorer, which
requires that we provide this missing functionality. There are two ways outlined below to accomplish this, though other are possible.</p>
<h2>Polyfill Service</h2>
<p>If acceptable to your design and security requirements you can use a service to provide missing functionality. This loads scripts from a service outside of your and our
control, so please ensure you understand any associated risks.</p>
<p>To use this option you need to wrap the code in a function, here called “stuffisloaded”. Then you need to add another script tag as shown below that will load what you need from the polyfill service. Note the parameter “callback” takes our function name.</p>
<pre><code class="language-HTML"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://mysite/site assests/pnpjs.es5.umd.bundle.min.js"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// this function will be executed once the polyfill is loaded.</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stuffisloaded</span>(<span class="hljs-params"></span>) </span>{

  $pnp.sp.web.select(<span class="hljs-string">"Title"</span>).get()
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{
      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"main"</span>).innerText=data.Title;
  })   
  .catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{  
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"main"</span>).innerText=err;
  });
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-comment">&lt;!-- This script tag loads the required polyfills from the service --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.polyfill.io/v2/polyfill.min.js?callback=stuffisloaded&amp;features=es6|always|gated,fetch|always|gated"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2>Module Loader</h2>
<p>If you are using a module loader you need to load the following two files as well. You can do this form a CDN or your style library.</p>
<ol>
<li>Download the <strong>es6-promises</strong> polyfill from <a href="https://github.com/stefanpenner/es6-promise">https://github.com/stefanpenner/es6-promise</a> and upload it to your style library.</li>
<li>Download the <strong>fetch</strong> polyfill from <a href="https://github.com/github/fetch">https://github.com/github/fetch</a> and upload it to your style library.</li>
<li>Update your module loader to set these files as dependencies before the pnp library is opened.</li>
</ol>
<p>One issue you still may see is that you get errors that certain libraries are undefined when you try to run your code. This is because your code is running before
these libraries are loaded. You need to ensure that all dependencies are loaded <strong>before</strong> making use of the pnp libraries.</p>

    </article>

    <footer>
        &copy; Microsoft 2018
        <br /> Please
        <a href="https://github.com/pnp/pnp/issues/new?title=Documentation: polyfills.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnp/ghpages/polyfills" alt="spacer" />