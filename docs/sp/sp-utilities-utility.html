<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div class="right">
            <form method="get" action="http://www.bing.com/search">
                <input type="text" name="q" size="25" maxlength="255" value="" placeholder="Search this site..." />
                <input type="hidden" name="q1" value="site:https://pnp.github.io/pnpjs/" />
                <input type="submit" value="Search" />
            </form>
        </div>
        <div class="logo">
            <img src="/pnpjs/img/office365-header-icon.png" alt="Logo" />
        </div>
        <div class="pnp-title">
            <span id="headerText">
                <a href="/pnpjs">SharePoint Patterns and Practices</a>
            </span>
            <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp">sp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp/sp-utilities-utility.html">sp utilities utility</a>
    </nav>

    <article>
        <h1 id="%40pnp%2Fsp%2Futilities">@pnp/sp/utilities <a class="permalink" href="#%40pnp%2Fsp%2Futilities" aria-hidden="true">#</a></h1>
<p>Through the REST api you are able to call a subset of the SP.Utilities.Utility methods. We have explicitly defined some of these methods and provided a method to call any others in a generic manner. These methods are exposed on pnp.sp.utility and support batching and caching.</p>
<h2 id="sendemail">sendEmail <a class="permalink" href="#sendemail" aria-hidden="true">#</a></h2>
<p>This methods allows you to send an email based on the supplied arguments. The method takes a single argument, a plain object defined by the EmailProperties interface (shown below).</p>
<h3 id="emailproperties">EmailProperties <a class="permalink" href="#emailproperties" aria-hidden="true">#</a></h3>
<pre><code class="language-TypeScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> EmailProperties {

    To: <span class="hljs-built_in">string</span>[];
    CC?: <span class="hljs-built_in">string</span>[];
    BCC?: <span class="hljs-built_in">string</span>[];
    Subject: <span class="hljs-built_in">string</span>;
    Body: <span class="hljs-built_in">string</span>;
    AdditionalHeaders?: TypedHash&lt;<span class="hljs-built_in">string</span>&gt;;
    From?: <span class="hljs-built_in">string</span>;
}
</code></pre>
<h3 id="usage">Usage <a class="permalink" href="#usage" aria-hidden="true">#</a></h3>
<p>You must define the To, Subject, and Body values - the remaining are optional.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp, { EmailProperties } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">const</span> emailProps: EmailProperties = {
    To: [<span class="hljs-string">"user@site.com"</span>],
    CC: [<span class="hljs-string">"user2@site.com"</span>, <span class="hljs-string">"user3@site.com"</span>],
    Subject: <span class="hljs-string">"This email is about..."</span>,
    Body: <span class="hljs-string">"Here is the body. &lt;b&gt;It supports html&lt;/b&gt;"</span>,
};

pnp.sp.utility.sendEmail(emailProps).then(_ =&gt; {

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Email Sent!"</span>);
});
</code></pre>
<h2 id="getcurrentuseremailaddresses">getCurrentUserEmailAddresses <a class="permalink" href="#getcurrentuseremailaddresses" aria-hidden="true">#</a></h2>
<p>This method returns the current userâ€™s email addresses known to SharePoint.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

pnp.sp.utility.getCurrentUserEmailAddresses().then(<span class="hljs-function">(<span class="hljs-params">addressString: <span class="hljs-built_in">string</span></span>) =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(addressString);
});
</code></pre>
<h2 id="resolveprincipal">resolvePrincipal <a class="permalink" href="#resolveprincipal" aria-hidden="true">#</a></h2>
<p>Gets information about a principal that matches the specified Search criteria</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp, { PrincipalType, PrincipalSource, PrincipalInfo } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

pnp.sp.utility.resolvePrincipal(<span class="hljs-string">"user@site.com"</span>,
    PrincipalType.User,
    PrincipalSource.All,
    <span class="hljs-literal">true</span>,
    <span class="hljs-literal">false</span>).then(<span class="hljs-function">(<span class="hljs-params">principal: PrincipalInfo</span>) =&gt;</span> {


        <span class="hljs-built_in">console</span>.log(principal);
    });
</code></pre>
<h2 id="searchprincipals">searchPrincipals <a class="permalink" href="#searchprincipals" aria-hidden="true">#</a></h2>
<p>Gets information about the principals that match the specified Search criteria.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp, { PrincipalType, PrincipalSource, PrincipalInfo } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

pnp.sp.utility.searchPrincipals(<span class="hljs-string">"john"</span>,
    PrincipalType.User,
    PrincipalSource.All,
    <span class="hljs-string">""</span>,
    <span class="hljs-number">10</span>).then(<span class="hljs-function">(<span class="hljs-params">principals: PrincipalInfo[]</span>) =&gt;</span> {

        <span class="hljs-built_in">console</span>.log(principals);
    });
</code></pre>
<h2 id="createemailbodyforinvitation">createEmailBodyForInvitation <a class="permalink" href="#createemailbodyforinvitation" aria-hidden="true">#</a></h2>
<p>Gets the external (outside the firewall) URL to a document or resource in a site.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

pnp.sp.utility.createEmailBodyForInvitation(<span class="hljs-string">"https://contoso.sharepoint.com/sites/dev/SitePages/DevHome.aspx"</span>).then(<span class="hljs-function">(<span class="hljs-params">r: <span class="hljs-built_in">string</span></span>) =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(r);
});
</code></pre>
<h2 id="expandgroupstoprincipals">expandGroupsToPrincipals <a class="permalink" href="#expandgroupstoprincipals" aria-hidden="true">#</a></h2>
<p>Resolves the principals contained within the supplied groups</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp, { PrincipalInfo } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

pnp.sp.utility.expandGroupsToPrincipals([<span class="hljs-string">"Dev Owners"</span>, <span class="hljs-string">"Dev Members"</span>]).then(<span class="hljs-function">(<span class="hljs-params">principals: PrincipalInfo[]</span>) =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(principals);
});

<span class="hljs-comment">// optionally supply a max results count. Default is 30.</span>
pnp.sp.utility.expandGroupsToPrincipals([<span class="hljs-string">"Dev Owners"</span>, <span class="hljs-string">"Dev Members"</span>], <span class="hljs-number">10</span>).then(<span class="hljs-function">(<span class="hljs-params">principals: PrincipalInfo[]</span>) =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(principals);
});
</code></pre>
<h2 id="createwikipage">createWikiPage <a class="permalink" href="#createwikipage" aria-hidden="true">#</a></h2>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp, { CreateWikiPageResult } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

pnp.sp.utility.createWikiPage({
    ServerRelativeUrl: <span class="hljs-string">"/sites/dev/SitePages/mynewpage.aspx"</span>,
    WikiHtmlContent: <span class="hljs-string">"This is my &lt;b&gt;page&lt;/b&gt; content. It supports rich html."</span>,
}).then(<span class="hljs-function">(<span class="hljs-params">result: CreateWikiPageResult</span>) =&gt;</span> {

    <span class="hljs-comment">// result contains the raw data returned by the service</span>
    <span class="hljs-built_in">console</span>.log(result.data);

    <span class="hljs-comment">// result contains a File instance you can use to further update the new page</span>
    result.file.get().then(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> {
        
        <span class="hljs-built_in">console</span>.log(f);
    });
});
</code></pre>
<h2 id="call-other-methods">Call Other Methods <a class="permalink" href="#call-other-methods" aria-hidden="true">#</a></h2>
<p>Even if a method does not have an explicit implementation on the utility api you can still call it using the UtilityMethod class. In this example we will show calling the GetLowerCaseString method, but the technique works for any of the utility methods.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp, { UtilityMethod } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// the first parameter is the web url. You can use an empty string for the current web,</span>
<span class="hljs-comment">// or specify it to call other web's. The second parameter is the method name.</span>
<span class="hljs-keyword">const</span> method = <span class="hljs-keyword">new</span> UtilityMethod(<span class="hljs-string">""</span>, <span class="hljs-string">"GetLowerCaseString"</span>);

<span class="hljs-comment">// you must supply the correctly formatted parameters to the execute method which</span>
<span class="hljs-comment">// is generic and types the result as the supplied generic type parameter.</span>
method.excute&lt;<span class="hljs-built_in">string</span>&gt;({
    sourceValue: <span class="hljs-string">"HeRe IS my StrINg"</span>,
    lcid: <span class="hljs-number">1033</span>,
}).then(<span class="hljs-function">(<span class="hljs-params">s: <span class="hljs-built_in">string</span></span>) =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(s);
});
</code></pre>

    </article>

    <footer>
        <div class="brand">Â© Microsoft 2018</div>
        <div class="call-to-action">Please
            <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp\sp-utilities-utility.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp/docs/sp-utilities-utility" alt="spacer" />