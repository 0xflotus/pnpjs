<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div class="right">
            <form method="get" action="http://www.bing.com/search">
                <input type="text" name="q" size="25" maxlength="255" value="" placeholder="Search this site..." />
                <input type="hidden" name="q1" value="site:https://pnp.github.io/pnpjs/" />
                <input type="submit" value="Search" />
            </form>
        </div>
        <div class="logo">
            <img src="/pnpjs/img/office365-header-icon.png" alt="Logo" />
        </div>
        <div class="pnp-title">
            <span id="headerText">
                <a href="/pnpjs">SharePoint Patterns and Practices</a>
            </span>
            <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp">sp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp/attachments.html">attachments</a>
    </nav>

    <article>
        <h1 id="%40pnp%2Fsp%2Fattachments">@pnp/sp/attachments <a class="permalink" href="#%40pnp%2Fsp%2Fattachments" aria-hidden="true">#</a></h1>
<p>The ability to attach file to list items allows users to track documents outside of a document library. You can use the PnP JS Core library to work with attachments as outlined below.</p>
<h2 id="get-attachments">Get attachments <a class="permalink" href="#get-attachments" aria-hidden="true">#</a></h2>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">let</span> item = pnp.sp.web.lists.getByTitle(<span class="hljs-string">"MyList"</span>).items.getById(<span class="hljs-number">1</span>);

<span class="hljs-comment">// get all the attachments</span>
item.attachmentFiles.get().then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});

<span class="hljs-comment">// get a single file by file name</span>
item.attachmentFiles.getByName(<span class="hljs-string">"file.txt"</span>).get().then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});

<span class="hljs-comment">// select specific properties using odata operators</span>
item.attachmentFiles.select(<span class="hljs-string">"ServerRelativeUrl"</span>).get().then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});
</code></pre>
<h2 id="add-an-attachment">Add an Attachment <a class="permalink" href="#add-an-attachment" aria-hidden="true">#</a></h2>
<p>You can add an attachment to a list item using the add method. This method takes either a string, Blob, or ArrayBuffer.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">let</span> item = pnp.sp.web.lists.getByTitle(<span class="hljs-string">"MyList"</span>).items.getById(<span class="hljs-number">1</span>);

item.attachmentFiles.add(<span class="hljs-string">"file2.txt"</span>, <span class="hljs-string">"Here is my content"</span>).then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});
</code></pre>
<h2 id="add-multiple">Add Multiple <a class="permalink" href="#add-multiple" aria-hidden="true">#</a></h2>
<p>This method allows you to pass an array of AttachmentFileInfo plain objects that will be added one at a time as attachments. Essentially automating the promise chaining.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">const</span> list = pnp.sp.web.lists.getByTitle(<span class="hljs-string">"MyList"</span>);

<span class="hljs-keyword">var</span> fileInfos: AttachmentFileInfo[] = [];

fileInfos.push({
    name: <span class="hljs-string">"My file name 1"</span>,
    content: <span class="hljs-string">"string, blob, or array"</span>
});

fileInfos.push({
    name: <span class="hljs-string">"My file name 2"</span>,
    content: <span class="hljs-string">"string, blob, or array"</span>
});

list.items.getById(<span class="hljs-number">2</span>).attachmentFiles.addMultiple(fileInfos).then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(r);
});
</code></pre>
<h2 id="delete-multiple">Delete Multiple <a class="permalink" href="#delete-multiple" aria-hidden="true">#</a></h2>
<pre><code class="language-TypeScript"><span class="hljs-keyword">const</span> list = pnp.sp.web.lists.getByTitle(<span class="hljs-string">"MyList"</span>);

list.items.getById(<span class="hljs-number">2</span>).attachmentFiles.deleteMultiple(<span class="hljs-string">"1.txt"</span>,<span class="hljs-string">"2.txt"</span>).then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(r);
});
</code></pre>
<h2 id="read-attachment-content">Read Attachment Content <a class="permalink" href="#read-attachment-content" aria-hidden="true">#</a></h2>
<p>You can read the content of an attachment as a string, Blob, ArrayBuffer, or json using the methods supplied.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">let</span> item = pnp.sp.web.lists.getByTitle(<span class="hljs-string">"MyList"</span>).items.getById(<span class="hljs-number">1</span>);

item.attachmentFiles.getByName(<span class="hljs-string">"file.txt"</span>).getText().then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});

<span class="hljs-comment">// use this in the browser, does not work in nodejs</span>
item.attachmentFiles.getByName(<span class="hljs-string">"file.mp4"</span>).getBlob().then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});

<span class="hljs-comment">// use this in nodejs</span>
item.attachmentFiles.getByName(<span class="hljs-string">"file.mp4"</span>).getBuffer().then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});

<span class="hljs-comment">// file must be valid json</span>
item.attachmentFiles.getByName(<span class="hljs-string">"file.json"</span>).getJSON().then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});
</code></pre>
<h2 id="update-attachment-content">Update Attachment Content <a class="permalink" href="#update-attachment-content" aria-hidden="true">#</a></h2>
<p>You can also update the content of an attachment. This API is limited compared to the full file API - so if you need to upload large files consider using a document library.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">let</span> item = pnp.sp.web.lists.getByTitle(<span class="hljs-string">"MyList"</span>).items.getById(<span class="hljs-number">1</span>);

item.attachmentFiles.getByName(<span class="hljs-string">"file2.txt"</span>).setContent(<span class="hljs-string">"My new content!!!"</span>).then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});
</code></pre>
<h2 id="delete-attachment">Delete Attachment <a class="permalink" href="#delete-attachment" aria-hidden="true">#</a></h2>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> pnp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">let</span> item = pnp.sp.web.lists.getByTitle(<span class="hljs-string">"MyList"</span>).items.getById(<span class="hljs-number">1</span>);

item.attachmentFiles.getByName(<span class="hljs-string">"file2.txt"</span>).delete().then(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(v);
});
</code></pre>

    </article>

    <footer>
        <div class="brand">Â© Microsoft 2018</div>
        <div class="call-to-action">Please
            <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp\attachments.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp/docs/attachments" alt="spacer" />