<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <span id="headerText">
            <a href="/pnpjs">SharePoint Patterns and Practices</a>
        </span>
        <span id="subheaderText">Client Side Libraries</span>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp">sp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp/client-side-pages.html">client side pages</a>
    </nav>

    <article>
        <h1>@pnp/sp/clientsidepages</h1>
<p>The ability to manage client-side pages is a capability introduced in version 1.0.2 of @pnp/sp. Through the methods described
you can add and edit “modern” pages in SharePoint sites.</p>
<h2>Add Client-side page</h2>
<p>Using the addClientSidePage you can add a new client side page to a site, specifying the filename.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> sp.web.addClientSidePage(<span class="hljs-string">`MyFirstPage.aspx`</span>);
</code></pre>
<h2>Load Client-side page</h2>
<p>You can also load an existing page based on the file representing that page. Note that the static fromFile returns a promise which
resolves so the loaded page. Here we are showing use of the getFileByServerRelativeUrl method to get the File instance, but any of the ways
of <a href="files.html">getting a File instance</a> will work. Also note we are passing the File instance, not the file content.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { 
    sp,
    ClientSidePage,
} <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> ClientSidePage.fromFile(sp.web.getFileByServerRelativeUrl(<span class="hljs-string">"/sites/dev/SitePages/ExistingFile.aspx"</span>));
</code></pre>
<p><strong>The remaining examples below reference a variable “page” which is assumed to be a ClientSidePage instance loaded through one of the above means.</strong></p>
<h2>Add Controls</h2>
<p>A client-side page is made up of sections, which have columns, which contain controls. A new page will have none of these and an existing page may have
any combination of these. There are a few rules to understand how sections and columns layout on a page for display. A section is a horizontal piece of
a page that extends 100% of the page width. A page with multiple sections will stack these sections based on the section’s order property - a 1 based index.</p>
<p>Within a section you can have one or more columns. Each column is ordered left to right based on the column’s order property. The width of each column is
controlled by the factor property whose value is one of 0, 2, 4, 6, 8, 10, or 12. The columns in a section should have factors that add up to 12. Meaning
if you wanted to have two equal columns you can set a factor of 6 for each. A page can have empty columns.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { 
    sp, 
    ClientSideText, 
} <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// this code adds a section, and then adds a control to that section. The control is added to the section's defaultColumn, and if there are no columns a single</span>
<span class="hljs-comment">// column of factor 12 is created as a default. Here we add the ClientSideText part</span>
page.addSection().addControl(<span class="hljs-keyword">new</span> ClientSideText(<span class="hljs-string">"@pnp/sp is a great library!"</span>));

<span class="hljs-comment">// here we add a section, add two columns, and add a text control to the second section so it will appear on the right of the page</span>
<span class="hljs-comment">// add and get a reference to a new section</span>
<span class="hljs-keyword">const</span> section = page.addSection();

<span class="hljs-comment">// add a column of factor 6</span>
section.addColumn(<span class="hljs-number">6</span>);

<span class="hljs-comment">// add and get a reference to a new column of factor 6</span>
<span class="hljs-keyword">const</span> column = section.addColumn(<span class="hljs-number">6</span>);

<span class="hljs-comment">// add a text control to the second new column</span>
column.addControl(<span class="hljs-keyword">new</span> ClientSideText(<span class="hljs-string">"Be sure to check out the @pnp docs at https://pnp.github.io/pnpjs/"</span>));

<span class="hljs-comment">// we need to save our content changes</span>
<span class="hljs-keyword">await</span> page.save();
</code></pre>
<h2>Add Client-side Web Parts</h2>
<p>Beyond the text control above you can also add any of the available client-side web parts in a given site. To find out what web parts are available you
first call the web’s getClientSideWebParts method. Once you have a list of parts you need to find the defintion you want to use, here we get the Embed web part
whose’s id is “490d7c76-1824-45b2-9de3-676421c997fa” (at least in one farm, your mmv).</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> {
    sp,
    ClientSideWebpart,
    ClientSideWebpartPropertyTypes,
} <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// this will be a ClientSidePageComponent array</span>
<span class="hljs-comment">// this can be cached on the client in production scenarios</span>
<span class="hljs-keyword">const</span> partDefs = <span class="hljs-keyword">await</span> sp.web.getClientSideWebParts();

<span class="hljs-comment">// find the definition we want, here by id</span>
<span class="hljs-keyword">const</span> partDef = partDefs.filter(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c.Id === <span class="hljs-string">"490d7c76-1824-45b2-9de3-676421c997fa"</span>);

<span class="hljs-comment">// optionally ensure you found the def</span>
<span class="hljs-keyword">if</span> (partDef.length &lt; <span class="hljs-number">1</span>) {
    <span class="hljs-comment">// we didn't find it so we throw an error</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Could not find the web part"</span>);
}

<span class="hljs-comment">// create a ClientWebPart instance from the definition</span>
<span class="hljs-keyword">const</span> part = ClientSideWebpart.fromComponentDef(partDef[<span class="hljs-number">0</span>]);

<span class="hljs-comment">// set the properties on the web part. Here we have imported the ClientSideWebpartPropertyTypes module and can use that to type</span>
<span class="hljs-comment">// the available settings object. You can use your own types or help us out and add some typings to the module :).</span>
<span class="hljs-comment">// here for the embed web part we only have to supply an embedCode - in this case a youtube video.</span>
part.setProperties&lt;ClientSideWebpartPropertyTypes.Embed&gt;({
    embedCode: <span class="hljs-string">"https://www.youtube.com/watch?v=IWQFZ7Lx-rg"</span>,
});

<span class="hljs-comment">// we add that part to a new section</span>
page.addSection().addControl(part);

<span class="hljs-comment">// save our content changes back to the server</span>
<span class="hljs-keyword">await</span> page.save();
</code></pre>
<h2>Find Controls</h2>
<p>Added in <em>1.0.3</em></p>
<p>You can use the either of the two available method to locate controls within a page. These method search through all sections, columns, and controls returning the first instance that meets the supplied criteria.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { ClientSideWebPart } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// find a control by instance id</span>
<span class="hljs-keyword">const</span> control1 = page.findControlById(<span class="hljs-string">"b99bfccc-164e-4d3d-9b96-da48db62eb78"</span>);

<span class="hljs-comment">// type the returned control</span>
<span class="hljs-keyword">const</span> control2 = page.findControlById&lt;ClientSideWebPart&gt;(<span class="hljs-string">"c99bfccc-164e-4d3d-9b96-da48db62eb78"</span>);
<span class="hljs-keyword">const</span> control3 = page.findControlById&lt;ClientSideText&gt;(<span class="hljs-string">"a99bfccc-164e-4d3d-9b96-da48db62eb78"</span>);

<span class="hljs-comment">// use any predicate to find a control</span>
<span class="hljs-keyword">const</span> control4 = page2.findControl&lt;ClientSideWebpart&gt;<span class="hljs-function">(<span class="hljs-params">(<span class="hljs-params">c: CanvasControl</span>) =&gt; {

    <span class="hljs-comment">// any logic you wish can be used on the control here</span>
    <span class="hljs-comment">// return true to return that control</span>
    <span class="hljs-keyword">return</span> c.order &gt; 3;
}</span>);
</span></code></pre>
<h2>Control Comments</h2>
<p>You can choose to enable or disable comments on a page using these methods</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">// indicates if comments are disabled, not valid until the page is loaded (Added in _1.0.3_)</span>
page.commentsDisabled

<span class="hljs-comment">// enable comments</span>
<span class="hljs-keyword">await</span> page.enableComments();

<span class="hljs-comment">// disable comments</span>
<span class="hljs-keyword">await</span> page.disableComments();
</code></pre>

    </article>

    <footer>
        &copy; Microsoft 2018
        <br /> Please
        <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp\client-side-pages.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp/docs/client-side-pages" alt="spacer" />