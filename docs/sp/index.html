<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <span id="headerText">
            <a href="/pnpjs">SharePoint Patterns and Practices</a>
        </span>
        <span id="subheaderText">Client Side Libraries</span>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp">sp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp/index.html">index</a>
    </nav>

    <article>
        <h1>@pnp/sp</h1>
<p><a href="https://badge.fury.io/js/%40pnp%2Fsp"><img src="https://badge.fury.io/js/%40pnp%2Fsp.svg" alt="npm version" /></a></p>
<p>This package contains the fluent api used to call the SharePoint rest services.</p>
<h2>Getting Started</h2>
<p>Install the library and required dependencies</p>
<p><code>npm install @pnp/logging @pnp/common @pnp/odata @pnp/sp --save</code></p>
<p>Import the library into your application and access the root sp object</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{

    <span class="hljs-comment">// here we will load the current web's title</span>
    sp.web.select(<span class="hljs-string">"Title"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Web Title: <span class="hljs-subst">${w.Title}</span>`</span>);
    });
})()
</code></pre>
<h2>Getting Started: SharePoint Framework</h2>
<p>Install the library and required dependencies</p>
<p><code>npm install @pnp/logging @pnp/common @pnp/odata @pnp/sp --save</code></p>
<p>Import the library into your application, update OnInit, and access the root sp object in render</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">public</span> onInit(): <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onInit().then(_ =&gt; {

    <span class="hljs-comment">// other init code may be present</span>

    sp.setup({
      spfxContext: <span class="hljs-keyword">this</span>.context
    });
  });
}

<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">public</span> render(): <span class="hljs-built_in">void</span> {

    <span class="hljs-comment">// A simple loading message</span>
    <span class="hljs-keyword">this</span>.domElement.innerHTML = <span class="hljs-string">`Loading...`</span>;

    sp.web.select(<span class="hljs-string">"Title"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

        <span class="hljs-keyword">this</span>.domElement.innerHTML = <span class="hljs-string">`Web Title: <span class="hljs-subst">${w.Title}</span>`</span>;
    });
}
</code></pre>
<h2>Getting Started: Nodejs</h2>
<p>Install the library and required dependencies</p>
<p><code>npm install @pnp/logging @pnp/common @pnp/odata @pnp/sp @pnp/nodejs --save</code></p>
<p>Import the library into your application, setup the node client, make a request</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;
<span class="hljs-keyword">import</span> { SPFetchClient } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/nodejs"</span>;

<span class="hljs-comment">// do this once per page load</span>
sp.setup({
    sp: {
        fetchClientFactory: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SPFetchClient(<span class="hljs-string">"{your site url}"</span>, <span class="hljs-string">"{your client id}"</span>, <span class="hljs-string">"{your client secret}"</span>);
        },
    },
});

<span class="hljs-comment">// now make any calls you need using the configured client</span>
sp.web.select(<span class="hljs-string">"Title"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Web Title: <span class="hljs-subst">${w.Title}</span>`</span>);
});
</code></pre>
<h2>Library Topics</h2>
<ul>
<li><a href="alias-parameters.html">Alias Parameters</a></li>
<li><a href="alm.html">ALM api</a></li>
<li><a href="attachments.html">Attachments</a></li>
<li><a href="client-side-pages.html">Client-side Pages</a></li>
<li><a href="features.html">Features</a></li>
<li><a href="fields.html">Fields</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="items.html">List Items</a></li>
<li><a href="navigation-service.html">Navigation Service</a></li>
<li><a href="permissions.html">Permissions</a></li>
<li><a href="related-items.html">Related Items</a></li>
<li><a href="search.html">Search</a></li>
<li><a href="sharing.html">Sharing</a></li>
<li><a href="social.html">Social</a></li>
<li><a href="sp-utilities-utility.html">SP.Utilities.Utility</a></li>
<li><a href="tenant-properties.html">Tenant Properties</a></li>
<li><a href="views.html">Views</a></li>
<li><a href="webs.html">Webs</a></li>
<li><a href="comments-likes.html">Comments and Likes</a></li>
</ul>

    </article>

    <footer>
        &copy; Microsoft 2018
        <br /> Please
        <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp\index.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp/docs/index" alt="spacer" />