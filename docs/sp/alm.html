<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div class="right">
            <form method="get" action="http://www.bing.com/search">
                <input type="text" name="q" size="25" maxlength="255" value="" placeholder="Search this site..." />
                <input type="hidden" name="q1" value="site:https://pnp.github.io/pnpjs/" />
                <input type="submit" value="Search" />
            </form>
        </div>
        <div class="logo">
            <img src="/pnpjs/img/office365-header-icon.png" alt="Logo" />
        </div>
        <div class="pnp-title">
            <span id="headerText">
                <a href="/pnpjs">SharePoint Patterns and Practices</a>
            </span>
            <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp">sp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp/alm.html">alm</a>
    </nav>

    <article>
        <h1 id="%40pnp%2Fsp%2Fappcatalog">@pnp/sp/appcatalog <a class="permalink" href="#%40pnp%2Fsp%2Fappcatalog" aria-hidden="true">#</a></h1>
<p>The ALM api allows you to manage app installations both in the tenant app catalog and individual site app catalogs. Some of the methods are still in beta and as such may change in the future. This article outlines how to call this api using @pnp/sp. Remember all these actions are bound by permissions so it is likely most users will not have the rights to perform these ALM actions.</p>
<h3 id="understanding-the-app-catalog-heirarchy">Understanding the App Catalog Heirarchy <a class="permalink" href="#understanding-the-app-catalog-heirarchy" aria-hidden="true">#</a></h3>
<p>Before you begin provisioning applications it is important to understand the relationship between a local web catalog and the tenant app catalog. Some of the methods described below only work within the context of the tenant app catalog web, such as adding an app to the catalog and the app actions retract, remove, and deploy. You can install, uninstall, and upgrade an app in any web. <a href="https://docs.microsoft.com/en-us/sharepoint/dev/apis/alm-api-for-spfx-add-ins">Read more in the official documentation</a>.</p>
<h2 id="reference-an-app-catalog">Reference an App Catalog <a class="permalink" href="#reference-an-app-catalog" aria-hidden="true">#</a></h2>
<p>There are several ways using @pnp/sp to get a reference to an app catalog. These methods are to provide you the greatest amount of flexibility in gaining access to the app catalog. Ultimately each method produces an AppCatalog instance differentiated only by the web to which it points.</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">// get the curren't context web's app catalog</span>
<span class="hljs-keyword">const</span> catalog = pnp.sp.web.getAppCatalog();

<span class="hljs-comment">// you can also chain off the app catalog</span>
pnp.sp.web.getAppCatalog().get().then(<span class="hljs-built_in">console</span>.log);
</code></pre>
<pre><code class="language-TypeScript"><span class="hljs-comment">// you can get the tenant app catalog (or any app catalog) by passing in a url</span>

<span class="hljs-comment">// get the tenant app catalog</span>
<span class="hljs-keyword">const</span> tenantCatalog = pnp.sp.web.getAppCatalog(<span class="hljs-string">"https://mytenant.sharepoint.com/sites/appcatalog"</span>);

<span class="hljs-comment">// get a different app catalog</span>
<span class="hljs-keyword">const</span> catalog = pnp.sp.web.getAppCatalog(<span class="hljs-string">"https://mytenant.sharepoint.com/sites/anothersite"</span>);
</code></pre>
<pre><code class="language-TypeScript"><span class="hljs-comment">// alternatively you can create a new app catalog instance directly by importing the AppCatalog class</span>
<span class="hljs-keyword">import</span> { AppCatalog } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">const</span> catalog = <span class="hljs-keyword">new</span> AppCatalog(<span class="hljs-string">"https://mytenant.sharepoint.com/sites/dev"</span>);
</code></pre>
<pre><code class="language-TypeScript"><span class="hljs-comment">// and finally you can combine use of the Web and AppCatalog classes to create an AppCatalog instance from an existing Web</span>
<span class="hljs-keyword">import</span> { Web, AppCatalog } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">const</span> web = <span class="hljs-keyword">new</span> Web(<span class="hljs-string">"https://mytenant.sharepoint.com/sites/dev"</span>);
<span class="hljs-keyword">const</span> catalog = <span class="hljs-keyword">new</span> AppCatalog(web);
</code></pre>
<p>The following examples make use of a variable “catalog” which is assumed to represent an AppCatalog instance obtained using one of the above methods, supporting code is omitted for brevity.</p>
<h2 id="list-available-apps">List Available Apps <a class="permalink" href="#list-available-apps" aria-hidden="true">#</a></h2>
<p>The AppCatalog is itself a queryable collection so you can query this object directly to get a list of available apps. Also, the odata operators work on the catalog to sort, filter, and select.</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">// get available apps</span>
catalog.get().then(<span class="hljs-built_in">console</span>.log);

<span class="hljs-comment">// get available apps selecting two fields</span>
catalog.select(<span class="hljs-string">"Title"</span>, <span class="hljs-string">"Deployed"</span>).get().then(<span class="hljs-built_in">console</span>.log);
</code></pre>
<h2 id="add-an-app">Add an App <a class="permalink" href="#add-an-app" aria-hidden="true">#</a></h2>
<p>This action must be performed in the context of the tenant app catalog</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">// this represents the file bytes of the app package file</span>
<span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> Blob();

<span class="hljs-comment">// there is an optional third argument to control overwriting existing files</span>
catalog.add(<span class="hljs-string">"myapp.app"</span>, blob).then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {

    <span class="hljs-comment">// this is at its core a file add operation so you have access to the response data as well</span>
    <span class="hljs-comment">// as a File isntance representing the created file</span>

    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(r.data, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));

    <span class="hljs-comment">// all file operations are available</span>
    r.file.select(<span class="hljs-string">"Name"</span>).get().then(<span class="hljs-built_in">console</span>.log);
});
</code></pre>
<h2 id="get-an-app">Get an App <a class="permalink" href="#get-an-app" aria-hidden="true">#</a></h2>
<p>You can get the details of a single app by GUID id. This is also the branch point to perform specific app actions</p>
<pre><code class="language-TypeScript">catalog.getAppById(<span class="hljs-string">"5137dff1-0b79-4ebc-8af4-ca01f7bd393c"</span>).get().then(<span class="hljs-built_in">console</span>.log);
</code></pre>
<h2 id="perform-app-actions">Perform app actions <a class="permalink" href="#perform-app-actions" aria-hidden="true">#</a></h2>
<p>Remember: retract, deploy, and remove only work in the context of the tenant app catalog web. All of these methods return void and you can monitor success using then and catch.</p>
<pre><code class="language-TypeScript">
<span class="hljs-comment">// deploy</span>
catalog.getAppById(<span class="hljs-string">"5137dff1-0b79-4ebc-8af4-ca01f7bd393c"</span>).deploy().then(<span class="hljs-built_in">console</span>.log).catch(<span class="hljs-built_in">console</span>.error);

<span class="hljs-comment">// retract</span>
catalog.getAppById(<span class="hljs-string">"5137dff1-0b79-4ebc-8af4-ca01f7bd393c"</span>).retract().then(<span class="hljs-built_in">console</span>.log).catch(<span class="hljs-built_in">console</span>.error);

<span class="hljs-comment">// install</span>
catalog.getAppById(<span class="hljs-string">"5137dff1-0b79-4ebc-8af4-ca01f7bd393c"</span>).install().then(<span class="hljs-built_in">console</span>.log).catch(<span class="hljs-built_in">console</span>.error);

<span class="hljs-comment">// uninstall</span>
catalog.getAppById(<span class="hljs-string">"5137dff1-0b79-4ebc-8af4-ca01f7bd393c"</span>).uninstall().then(<span class="hljs-built_in">console</span>.log).catch(<span class="hljs-built_in">console</span>.error);

<span class="hljs-comment">// upgrade</span>
catalog.getAppById(<span class="hljs-string">"5137dff1-0b79-4ebc-8af4-ca01f7bd393c"</span>).upgrade().then(<span class="hljs-built_in">console</span>.log).catch(<span class="hljs-built_in">console</span>.error);

<span class="hljs-comment">// remove</span>
catalog.getAppById(<span class="hljs-string">"5137dff1-0b79-4ebc-8af4-ca01f7bd393c"</span>).remove().then(<span class="hljs-built_in">console</span>.log).catch(<span class="hljs-built_in">console</span>.error);

</code></pre>
<h2 id="notes">Notes <a class="permalink" href="#notes" aria-hidden="true">#</a></h2>
<ul>
<li>The app catalog is just a document library under the hood, so you can also perform non-ALM actions on the library if needed. But you should be aware of possible side-effects to the ALM life-cycle when doing so.</li>
</ul>

    </article>

    <footer>
        <div class="brand">© Microsoft 2018</div>
        <div class="call-to-action">Please
            <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp\alm.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp/docs/alm" alt="spacer" />