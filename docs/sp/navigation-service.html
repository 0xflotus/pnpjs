<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <span id="headerText">
            <a href="/pnpjs">SharePoint Patterns and Practices</a>
        </span>
        <span id="subheaderText">Client Side Libraries</span>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp">sp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp/navigation-service.html">navigation service</a>
    </nav>

    <article>
        <h1>@pnp/sp/navigation service</h1>
<p>The global navigation service located at “_api/navigation” provides access to the SiteMapProvider instances available in a given site collection.</p>
<h2>getMenuState</h2>
<p>The MenuState service operation returns a Menu-State (dump) of a SiteMapProvider on a site. It will return an exception if the SiteMapProvider cannot be found on the site, the SiteMapProvider does not implement the IEditableSiteMapProvider interface or the SiteMapNode key cannot be found within the provider hierarchy.</p>
<p>The IEditableSiteMapProvider also supports Custom Properties which is an optional feature. What will be return in the custom properties is up to the IEditableSiteMapProvider implementation and can differ for for each SiteMapProvider implementation. The custom properties can be requested by providing a comma seperated string of property names like: property1,property2,property3\,containingcomma</p>
<p>NOTE: the , seperator can be escaped using the \ as escape character as done in the example above. The string above would split like:</p>
<ul>
<li>property1</li>
<li>property2</li>
<li>property3,containingcomma</li>
</ul>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> sp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// Will return a menu state of the default SiteMapProvider 'SPSiteMapProvider' where the dump starts a the RootNode (within the site) with a depth of 10 levels.</span>
sp.navigation.getMenuState().then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(r, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));

}).catch(<span class="hljs-built_in">console</span>.error);

<span class="hljs-comment">// Will return the menu state of the 'SPSiteMapProvider', starting with the node with the key '1002' with a depth of 5</span>
sp.navigation.getMenuState(<span class="hljs-string">"1002"</span>, <span class="hljs-number">5</span>).then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(r, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));

}).catch(<span class="hljs-built_in">console</span>.error);

<span class="hljs-comment">// Will return the menu state of the 'CurrentNavSiteMapProviderNoEncode' from the root node of the provider with a depth of 5</span>
sp.navigation.getMenuState(<span class="hljs-literal">null</span>, <span class="hljs-number">5</span>, <span class="hljs-string">"CurrentNavSiteMapProviderNoEncode"</span>).then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(r, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));

}).catch(<span class="hljs-built_in">console</span>.error);
</code></pre>
<h2>getMenuNodeKey</h2>
<p>Tries to get a SiteMapNode.Key for a given URL within a site collection. If the SiteMapNode cannot be found an Exception is returned. The method is using SiteMapProvider.FindSiteMapNodeFromKey(string rawUrl) to lookup the SiteMapNode. Depending on the actual implementation of FindSiteMapNodeFromKey the matching can differ for different SiteMapProviders.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> sp <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

sp.navigation.getMenuNodeKey(<span class="hljs-string">"/sites/dev/Lists/SPPnPJSExampleList/AllItems.aspx"</span>).then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(r, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));

}).catch(<span class="hljs-built_in">console</span>.error);
</code></pre>

    </article>

    <footer>
        &copy; Microsoft 2018
        <br /> Please
        <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp\navigation-service.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp/docs/navigation-service" alt="spacer" />