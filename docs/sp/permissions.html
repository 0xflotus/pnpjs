<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div class="right">
            <form method="get" action="http://www.bing.com/search">
                <input type="text" name="q" size="25" maxlength="255" value="" placeholder="Search this site..." />
                <input type="hidden" name="q1" value="site:https://pnp.github.io/pnpjs/" />
                <input type="submit" value="Search" />
            </form>
        </div>
        <div class="logo">
            <img src="/pnpjs/img/office365-header-icon.png" alt="Logo" />
        </div>
        <div class="pnp-title">
            <span id="headerText">
                <a href="/pnpjs">SharePoint Patterns and Practices</a>
            </span>
            <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp">sp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp/permissions.html">permissions</a>
    </nav>

    <article>
        <h1 id="%40pnp%2Fsp---permissions">@pnp/sp - permissions <a class="permalink" href="#%40pnp%2Fsp---permissions" aria-hidden="true">#</a></h1>
<p>A common task is to determine if a user or the current user has a certain permission level. It is a great idea to check before performing a task such as creating a list to ensure a user can without getting back an error. This allows you to provide a better experience to the user.</p>
<p>Permissions in SharePoint are assigned to the set of securable objects which include Site, Web, List, and List Item. These are the four level to which unique permissions can be assigned. As such @pnp/sp provides a set of methods defined in the <a href="queryablesecurable.html">QueryableSecurable</a> class to handle these permissions. These examples all use the Web to get the values, however the methods work identically on all securables.</p>
<h2 id="get-role-assignments">Get Role Assignments <a class="permalink" href="#get-role-assignments" aria-hidden="true">#</a></h2>
<p>This gets a collection of all the role assignments on a given securable. The property returns a RoleAssignments collection which supports the OData collection operators.</p>
<pre><code class="language-TypeScript">pnp.sp.web.roleAssignments.get().then(<span class="hljs-function"><span class="hljs-params">roles</span> =&gt;</span> {

    Logger.writeJSON(roles);
});
</code></pre>
<h2 id="first-unique-ancestor-securable-object">First Unique Ancestor Securable Object <a class="permalink" href="#first-unique-ancestor-securable-object" aria-hidden="true">#</a></h2>
<p>This method can be used to find the securable parent up the hierarchy that has unique permissions. If everything inherits permissions this will be the Site. If a sub web has unique permissions it will be the web, and so on.</p>
<pre><code class="language-TypeScript">pnp.sp.web.firstUniqueAncestorSecurableObject.get().then(<span class="hljs-function"><span class="hljs-params">obj</span> =&gt;</span> {

    Logger.writeJSON(obj);
});
</code></pre>
<h2 id="user-effective-permissions">User Effective Permissions <a class="permalink" href="#user-effective-permissions" aria-hidden="true">#</a></h2>
<p>This method returns the BasePermissions for a given user or the current user. This value contains the High and Low values for a user on the securable you have queried.</p>
<pre><code class="language-TypeScript">pnp.sp.web.getUserEffectivePermissions(<span class="hljs-string">"i:0#.f|membership|user@site.com"</span>).then(<span class="hljs-function"><span class="hljs-params">perms</span> =&gt;</span> {

    Logger.writeJSON(perms);
});

pnp.sp.web.getCurrentUserEffectivePermissions().then(<span class="hljs-function"><span class="hljs-params">perms</span> =&gt;</span> {

    Logger.writeJSON(perms);
});
</code></pre>
<h2 id="user-has-permissions">User Has Permissions <a class="permalink" href="#user-has-permissions" aria-hidden="true">#</a></h2>
<p>Because the High and Low values in the BasePermission don’t obviously mean anything you can use these methods along with the PermissionKind enumeration to check actual rights on the securable.</p>
<pre><code class="language-TypeScript">pnp.sp.web.userHasPermissions(<span class="hljs-string">"i:0#.f|membership|user@site.com"</span>, PermissionKind.ApproveItems).then(<span class="hljs-function"><span class="hljs-params">perms</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(perms);
});

pnp.sp.web.currentUserHasPermissions(PermissionKind.ApproveItems).then(<span class="hljs-function"><span class="hljs-params">perms</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(perms);
});
</code></pre>
<h2 id="has-permissions">Has Permissions <a class="permalink" href="#has-permissions" aria-hidden="true">#</a></h2>
<p>If you need to check multiple permissions it can be more efficient to get the BasePermissions once and then use the hasPermissions method to check them as shown below.</p>
<pre><code class="language-TypeScript">pnp.sp.web.getCurrentUserEffectivePermissions().then(<span class="hljs-function"><span class="hljs-params">perms</span> =&gt;</span> {

    <span class="hljs-keyword">if</span> (pnp.sp.web.hasPermissions(perms, PermissionKind.AddListItems) &amp;&amp; pnp.sp.web.hasPermissions(perms, PermissionKind.DeleteVersions)) {

        <span class="hljs-comment">// ...</span>
    }
});
</code></pre>

    </article>

    <footer>
        <div class="brand">© Microsoft 2018</div>
        <div class="call-to-action">Please
            <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp\permissions.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp/docs/permissions" alt="spacer" />