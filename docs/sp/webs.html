<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div class="right">
            <form method="get" action="http://www.bing.com/search">
                <input type="text" name="q" size="25" maxlength="255" value="" placeholder="Search this site..." />
                <input type="hidden" name="q1" value="site:https://pnp.github.io/pnpjs/" />
                <input type="submit" value="Search" />
            </form>
        </div>
        <div class="logo">
            <img src="/pnpjs/img/office365-header-icon.png" alt="Logo" />
        </div>
        <div class="pnp-title">
            <span id="headerText">
                <a href="/pnpjs">SharePoint Patterns and Practices</a>
            </span>
            <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp">sp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/sp/webs.html">webs</a>
    </nav>

    <article>
        <h1 id="%40pnp%2Fsp%2Fwebs">@pnp/sp/webs <a class="permalink" href="#%40pnp%2Fsp%2Fwebs" aria-hidden="true">#</a></h1>
<p>Webs are one of the fundamental entry points when working with SharePoint. Webs serve as a container for lists, features, sub-webs, and all of the entity types.</p>
<h2 id="add-a-web">Add a Web <a class="permalink" href="#add-a-web" aria-hidden="true">#</a></h2>
<p>Using the library you can add a web to another web’s collection of subwebs. The basic usage requires only a title and url. This will result in a team site with all of the default settings.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp, WebAddResult } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

sp.web.webs.add(<span class="hljs-string">"title"</span>, <span class="hljs-string">"subweb1"</span>).then(<span class="hljs-function">(<span class="hljs-params">w: WebAddResult</span>) =&gt;</span> {

    <span class="hljs-comment">// show the response from the server when adding the web</span>
    <span class="hljs-built_in">console</span>.log(w.data);

    w.web.select(<span class="hljs-string">"Title"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

        <span class="hljs-comment">// show our title</span>
        <span class="hljs-built_in">console</span>.log(w.Title);
    });
});
</code></pre>
<p>You can also provide other settings such as description, template, language, and inherit permissions.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp, WebAddResult } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// create a German language wiki site with title, url, description, which inherits permissions</span>
sp.web.webs.add(<span class="hljs-string">"wiki"</span>, <span class="hljs-string">"subweb2"</span>, <span class="hljs-string">"a wiki web"</span>, <span class="hljs-string">"WIKI#0"</span>, <span class="hljs-number">1031</span>, <span class="hljs-literal">true</span>).then(<span class="hljs-function">(<span class="hljs-params">w: WebAddResult</span>) =&gt;</span> {

    <span class="hljs-comment">// show the response from the server when adding the web</span>
    <span class="hljs-built_in">console</span>.log(w.data);

    w.web.select(<span class="hljs-string">"Title"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

        <span class="hljs-comment">// show our title</span>
        <span class="hljs-built_in">console</span>.log(w.Title);
    });
});
</code></pre>
<h2 id="get-a-web%E2%80%99s-properties">Get A Web’s properties <a class="permalink" href="#get-a-web%E2%80%99s-properties" aria-hidden="true">#</a></h2>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-comment">// basic get of the webs properties</span>
sp.web.get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(w.Title);
});

<span class="hljs-comment">// use odata operators to get specific fields</span>
sp.web.select(<span class="hljs-string">"Title"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(w.Title);
});

<span class="hljs-comment">// use with get to give the result a type</span>
sp.web.select(<span class="hljs-string">"Title"</span>).get&lt;{ Title: <span class="hljs-built_in">string</span> }&gt;().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(w.Title);
});
</code></pre>
<h2 id="get-complex-properties">Get Complex Properties <a class="permalink" href="#get-complex-properties" aria-hidden="true">#</a></h2>
<p>Some properties, such as AllProperties, are not returned by default. You can still access them using the expand operator.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { sp } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

sp.web.select(<span class="hljs-string">"AllProperties"</span>).expand(<span class="hljs-string">"AllProperties"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(w.AllProperties);
});
</code></pre>
<h2 id="get-a-web-directly">Get a Web Directly <a class="permalink" href="#get-a-web-directly" aria-hidden="true">#</a></h2>
<p>You can also use the Web object directly to get any web, though of course the current user must have the necessary permissions. This is done by importing the web object.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { Web } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">let</span> web = <span class="hljs-keyword">new</span> Web(<span class="hljs-string">"https://my-tenant.sharepoint.com/sites/mysite"</span>);

web.get().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(w);
});
</code></pre>
<h2 id="open-web-by-id">Open Web By Id <a class="permalink" href="#open-web-by-id" aria-hidden="true">#</a></h2>
<p>Because this method is a POST request you can chain off it directly. You will get back the full web properties in the data property of the return object. You can also chain directly off the returned Web instance on the web property.</p>
<pre><code class="language-TypeScript">sp.site.openWebById(<span class="hljs-string">"111ca453-90f5-482e-a381-cee1ff383c9e"</span>).then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-comment">//we got all the data from the web as well</span>
    <span class="hljs-built_in">console</span>.log(w.data);

    <span class="hljs-comment">// we can chain</span>
    w.web.select(<span class="hljs-string">"Title"</span>).get().then(<span class="hljs-function"><span class="hljs-params">w2</span> =&gt;</span> {
        <span class="hljs-comment">// ...</span>
    });
});
</code></pre>
<h2 id="update-web-properties">Update Web Properties <a class="permalink" href="#update-web-properties" aria-hidden="true">#</a></h2>
<p>You can update web properties using the update method. The properties available for update are listed in <a href="https://msdn.microsoft.com/en-us/library/office/dn499819.aspx#bk_WebProperties">this table</a>. Updating is a simple as passing a plain object with the properties you want to update.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { Web } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">let</span> web = <span class="hljs-keyword">new</span> Web(<span class="hljs-string">"https://my-tenant.sharepoint.com/sites/mysite"</span>);

web.update({
    Title: <span class="hljs-string">"New Title"</span>,
    CustomMasterUrl: <span class="hljs-string">"{path to masterpage}"</span>,
    Description: <span class="hljs-string">"My new description"</span>,
}).then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(w);
});
</code></pre>
<h2 id="delete-a-web">Delete a Web <a class="permalink" href="#delete-a-web" aria-hidden="true">#</a></h2>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { Web } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/sp"</span>;

<span class="hljs-keyword">let</span> web = <span class="hljs-keyword">new</span> Web(<span class="hljs-string">"https://my-tenant.sharepoint.com/sites/mysite"</span>);

web.delete().then(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> {

    <span class="hljs-built_in">console</span>.log(w);
});
</code></pre>

    </article>

    <footer>
        <div class="brand">© Microsoft 2018</div>
        <div class="call-to-action">Please
            <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: sp\webs.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/sp/docs/webs" alt="spacer" />