<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <header>
        SharePoint Patters and Practices
    </header>

    <article>
        <h1>@pnp/logging</h1>
<p>The logging module provides light weight subscribable and extensiable logging framework which is used internally and available for use in your projects. This article outlines how to setup logging and use the various loggers.</p>
<h3>Understanding the Logging Framework</h3>
<p>The logging framework is based on the Logger class to which any number of listeners can be subscribed. Each of these listeners will receive each of the messages logged. And each listener must implement the <em>LogListener</em> interface, shown below. There is only one method to implement and it takes an instance of the LogEntry interface, also shown.</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">/**
 * Interface that defines a log listner
 *
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> LogListener {
    <span class="hljs-comment">/**
     * Any associated data that a given logging listener may choose to log or ignore
     *
     * @param entry The information to be logged
     */</span>
    log(entry: LogEntry): <span class="hljs-built_in">void</span>;
}

<span class="hljs-comment">/**
 * Interface that defines a log entry
 *
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> LogEntry {
    <span class="hljs-comment">/**
     * The main message to be logged
     */</span>
    message: <span class="hljs-built_in">string</span>;
    <span class="hljs-comment">/**
     * The level of information this message represents
     */</span>
    level: LogLevel;
    <span class="hljs-comment">/**
     * Any associated data that a given logging listener may choose to log or ignore
     */</span>
    data?: <span class="hljs-built_in">any</span>;
}
</code></pre>
<h2>Writing to the Logger</h2>
<p>To write information to a logger you can use either write, writeJSON, or log.</p>
<pre><code class="language-TypeScript"><span class="hljs-comment">// write logs a simple string as the message value of the LogEntry</span>
Logger.write(<span class="hljs-string">"This is logging a simple string"</span>);

<span class="hljs-comment">// optionally passing a level, default level is Verbose</span>
Logger.write(<span class="hljs-string">"This is logging a simple string"</span>, LogLevel.Error);

<span class="hljs-comment">// this will convert the object to a string using JSON.stringify and set the message with the result</span>
Logger.writeJSON({ name: <span class="hljs-string">"value"</span>, name2: <span class="hljs-string">"value2"</span>});

<span class="hljs-comment">// optionally passing a level, default level is Verbose</span>
Logger.writeJSON({ name: <span class="hljs-string">"value"</span>, name2: <span class="hljs-string">"value2"</span>}, LogLevel.Warn);

<span class="hljs-comment">// specify the entire LogEntry interface using log</span>
Logger.log({
    data: { name: <span class="hljs-string">"value"</span>, name2: <span class="hljs-string">"value2"</span>},
    level: LogLevel.Warning,
    message: <span class="hljs-string">"This is my message"</span>
});
</code></pre>
<h2>Log an error</h2>
<p>There exists a shortcut method to log an error to the Logger. This will log an entry to the subscribed loggers where the data property will be the Error
instance pased in, the level will be Error, and the message will be a concatenation of the Error instance name and message.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">const</span> e = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"An Error"</span>);

Logger.error(e);
</code></pre>
<h2>Subscribing a Listener</h2>
<p>By default no listeners are subscribed, so if you would like to get logging information you need to subscribe at least one listener. This is done as shown below by importing the Logger and your listener(s) of choice. Here we are using the provided Console Listener. We are also setting the active log level, which controls the level of logging that will be output. Be aware that Verbose produces a substantial amount of data about each request.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> {
    Logger,
    ConsoleListener,
    LogLevel
} <span class="hljs-keyword">from</span> <span class="hljs-string">"sp-pnp-js"</span>;

<span class="hljs-comment">// subscribe a listener</span>
Logger.subscribe(<span class="hljs-keyword">new</span> ConsoleListener());

<span class="hljs-comment">// set the active log level</span>
Logger.activeLogLevel = LogLevel.Info;
</code></pre>
<h2>Available Listeners</h2>
<p>There are two listeners included in the library, ConsoleListener and FunctionListener.</p>
<h3>ConsoleListener</h3>
<p>This listener outputs information to the console and works in Node as well as within browsers. It takes no settings but does write to the appropriate console method based on message level. For example a LogEntry with level Warning will be written to console.warn. Usage is shown in the example above.</p>
<h3>FunctionListener</h3>
<p>The FunctionListener allows you to wrap any functionality by creating a function that takes a LogEntry as its single argument. This produces the same result as implementing the LogListener interface, but is useful if you already have a logging method or framework to which you want to pass the messages.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> {
    Logger,
    FunctionListener,
    LogEntry
} <span class="hljs-keyword">from</span> <span class="hljs-string">"sp-pnp-js"</span>;

<span class="hljs-keyword">let</span> listener = <span class="hljs-keyword">new</span> FunctionListener(<span class="hljs-function">(<span class="hljs-params">entry: LogEntry</span>) =&gt;</span> {

    <span class="hljs-comment">// pass all logging data to an existing framework</span>
    MyExistingCompanyLoggingFramework.log(entry.message);
});

Logger.subscribe(listener);
</code></pre>
<h3>Create a Custom Listener</h3>
<p>If desirable for your project you can create a custom listener to perform any logging action you would like. This is done by implementing the LogListener interface.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> {
    Logger,
    LogListener,
    LogEntry
} <span class="hljs-keyword">from</span> <span class="hljs-string">"sp-pnp-js"</span>;

<span class="hljs-keyword">class</span> MyListener <span class="hljs-keyword">implements</span> LogListener {

    log(entry: LogEntry): <span class="hljs-built_in">void</span> {
        <span class="hljs-comment">// here you would do something with the entry</span>
    }    
}

Logger.subscribe(<span class="hljs-keyword">new</span> MyListener());
</code></pre>

    </article>

    <footer>
        &copy; Microsoft<br />
        Please <a href="https://github.com/pnp/pnp/issues/new?title=Documentation: {your title}&body=Please describe how we can improve the doc page $$OriginalFilePath$$">report documentation issues</a> so we can improve things!
    </footer>
</body>

</html>