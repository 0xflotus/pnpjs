<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>@pnp - SharePoint Patterns and Practices JavaScript Libraries</title>
    <link rel="stylesheet" href="/pnpjs/css/highlightjs-github.css">
    <link rel="stylesheet" href="/pnpjs/css/site.css">
</head>

<body>
    <header>
        <div>
            <div class="logo">
                <img src="img/office365-header-icon.png" alt="Logo" />
            </div>
            <div class="pnp-title">
                <span id="headerText">
                    <a href="/pnpjs">SharePoint Patterns and Practices</a>
                </span>
                <span id="subheaderText">PnPjs: Client Side Libraries for Microsoft 365</span>
            </div>
        </div>
    </header>

    <nav id="breadcrumbs">
        <a href="/pnpjs">@pnp</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/common">common</a>&nbsp;&nbsp;&gt;&nbsp;&nbsp;<a href="/pnpjs/common/storage.html">storage</a>
    </nav>

    <article>
        <h1 id="pnpcommonstorage">@pnp/common/storage <a class="permalink" href="#pnpcommonstorage" aria-hidden="true">#</a></h1>
<p>This module provides a thin wrapper over the browser storage options, local and session. If neither option is available it shims storage with
a non-persistent in memory polyfill. Optionally through configuratrion you can activate expiration. Sample usage is shown below.</p>
<h2 id="pnpclientstorage">PnPClientStorage <a class="permalink" href="#pnpclientstorage" aria-hidden="true">#</a></h2>
<p>The main export of this module, contains properties representing local and session storage.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { PnPClientStorage } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/common"</span>;

<span class="hljs-keyword">const</span> storage = <span class="hljs-keyword">new</span> PnPClientStorage();
<span class="hljs-keyword">const</span> myvalue = storage.local.get(<span class="hljs-string">"mykey"</span>);
</code></pre>
<h2 id="pnpclientstoragewrapper">PnPClientStorageWrapper <a class="permalink" href="#pnpclientstoragewrapper" aria-hidden="true">#</a></h2>
<p>Each of the storage locations (session and local) are wrapped with this helper class. You can use it directly, but generally it would be used
from an instance of PnPClientStorage as shown below. These examples all use local storage, the operations are identical for session storage.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { PnPClientStorage } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/common"</span>;

<span class="hljs-keyword">const</span> storage = <span class="hljs-keyword">new</span> PnPClientStorage();

<span class="hljs-comment">// get a value from storage</span>
<span class="hljs-keyword">const</span> value = storage.local.get(<span class="hljs-string">"mykey"</span>);

<span class="hljs-comment">// put a value into storage</span>
storage.local.put(<span class="hljs-string">"mykey2"</span>, <span class="hljs-string">"my value"</span>);

<span class="hljs-comment">// put a value into storage with an expiration</span>
storage.local.put(<span class="hljs-string">"mykey2"</span>, <span class="hljs-string">"my value"</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>());

<span class="hljs-comment">// put a simple object into storage</span>
<span class="hljs-comment">// because JSON.stringify is used to package the object we do NOT do a deep rehydration of stored objects</span>
storage.local.put(<span class="hljs-string">"mykey3"</span>, {
    key: <span class="hljs-string">"value"</span>,
    key2: <span class="hljs-string">"value2"</span>,
});

<span class="hljs-comment">// remove a value from storage</span>
storage.local.delete(<span class="hljs-string">"mykey3"</span>);

<span class="hljs-comment">// get an item or add it if it does not exist</span>
<span class="hljs-comment">// returns a promise in case you need time to get the value for storage</span>
<span class="hljs-comment">// optionally takes a third parameter specifying the expiration</span>
storage.local.getOrPut(<span class="hljs-string">"mykey4"</span>, <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">"value"</span>);
});

<span class="hljs-comment">// delete expired items</span>
storage.local.deleteExpired();
</code></pre>
<h3 id="cache-expiration">Cache Expiration <a class="permalink" href="#cache-expiration" aria-hidden="true">#</a></h3>
<p>The ability remove of expired items based on a configured timeout can help if the cache is filling up. This can be accomplished in two ways. The first is to explicitly call the new deleteExpired method on the cache you wish to clear. A suggested usage is to add this into your page init code as clearing expired items once per page load is likely sufficient.</p>
<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> { PnPClientStorage } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/common"</span>;

<span class="hljs-keyword">const</span> storage = <span class="hljs-keyword">new</span> PnPClientStorage();

<span class="hljs-comment">// session storage</span>
storage.session.deleteExpired();

<span class="hljs-comment">// local storage</span>
storage.local.deleteExpired();

<span class="hljs-comment">// this returns a promise, so you can perform some activity after the expired items are removed:</span>
storage.local.deleteExpired().then(_ =&gt; {
    <span class="hljs-comment">// init my application</span>
});
</code></pre>
<p>The second method is to enable automated cache expiration through global config. Setting the enableCacheExpiration property to true will enable the timer. Optionally you can set the interval at which the cache is checked via the cacheExpirationIntervalMilliseconds property, by default 750 milliseconds is used. We enforce a minimum of 300 milliseconds as this functionality is enabled via setTimeout and there is little value in having an excessive number of cache checks. This method is more appropriate for a single page application where the page is infrequently reloaded and many cached operations are performed. There is no advantage to enabling cache expiration unless you are experiencing cache storage space pressure in a long running page - and you may see a performance hit due to the use of setTimeout.</p>
<pre><code class="language-TypeScript">
<span class="hljs-keyword">import</span> { setup } <span class="hljs-keyword">from</span> <span class="hljs-string">"@pnp/common"</span>;

setup({
    enableCacheExpiration: <span class="hljs-literal">true</span>,
    cacheExpirationIntervalMilliseconds: <span class="hljs-number">1000</span>, <span class="hljs-comment">// optional</span>
});
</code></pre>

    </article>

    <footer>
        <div class="brand">Â© Microsoft 2018</div>
        <div class="call-to-action">Please <a href="https://github.com/pnp/pnpjs/issues/new?title=Documentation: common\storage.html&body=Please describe how we can improve the doc page:">report documentation issues/suggestions</a> to help us improve!</div>
    </footer>
</body>

</html><img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/common/docs/storage" alt="spacer" />